#lang racket

; prog1.rkt
; Name: Jaden Miguel
; Date: Spring 2021
; Purpose: Program 1 - Predicate Logic
;
; This program contains ten logical expressions,
; as well as a procedure that implements the functionality
; of predicates, or open sentences whose truth value depends
; on their set of arguments.

;; helper functions

(define (contains? x S)
  (cond ((null? S) false)
        ((equal? x (car S)) true)
        (else (contains? x (cdr S)))))

(define (implies P Q)
  (or (not P) Q))

;; universe definitions

(define A '(hutchinson hearne fizzano 241 301 474 493 dennis doris spruce redwood rose))

;; definitions

(define is-faculty '((hutchinson) (hearne) (fizzano)))

(define is-course '((301) (241) (474) (493)))

(define is-student '((dennis) (doris)))

; (a,b,c) means faculty member a teaches course b to student c
(define teaches-to '((hutchinson 301 dennis) (hutchinson 241 doris) (hearne 301 doris) (hearne 493 dennis) (fizzano 474 doris))) 

(define is-person '((hutchinson) (hearne) (fizzano) (dennis) (doris)))

(define is-tree '((spruce) (redwood)))

(define is-plant '((spruce) (redwood) (rose)))

(define taller-than '((redwood spruce) (redwood doris) (redwood dennis) (spruce doris) (spruce dennis) (dennis doris)))

;; Predicate definitions

(define (is-faculty? x)
  (contains? (list x) is-faculty))

(define (is-course? x)
  (contains? (list x) is-course))

(define (is-student? x)
  (contains? (list x) is-student))

(define (teaches-to? prof course student)
  (contains? (list prof course student) teaches-to))

(define (is-person? x)
	(contains? (list x) is-person))

(define (is-tree? x)
  (contains? (list x) is-tree))

(define (is-plant? x)
  (contains? (list x) is-plant))

(define (taller-than? x y)
	(contains? (list x y) taller-than))


; predicate-logic
;
; Implements the functionality of predicates, or open sentences
; whose truth values depend on the arguments given to them.
;
; Parameters:
; U (list): The universe over which the quantifiers will quantify.
; Q (list): A list of quantifers of length k. ('forall, 'exists)
; E (procedure): A logical expression that accepts k variables.
;
; Returns:
; A boolean value, corresponding to whether or not the statement
; is true or false, after the quantifiers are applied over U to
; the logical expression.
(define (predicate-logic U Q E)
   ; conditions based on current quantifier
   (cond
     ; return curried expression if Q is null
     [(null? Q) E]
     ; check for quantifier and call helper function with recursion, and curried expression with next argument
     ; until k is reached. use universe U for element list.
     [(eq? (car Q) 'forall) (for-all (lambda (next-arg) (predicate-logic U (cdr Q) (curry E next-arg))) U)]
     [(eq? (car Q) 'exists) (exists (lambda (next-arg) (predicate-logic U (cdr Q) (curry E next-arg))) U)]))

; for-all
;
; Implements the functionality of the "for all" logical quantifier.
;
; Parameters:
; expr (procedure): The expression over which the procedure will test.
; vars (list): A list of elements from a given universe.
;
; Returns:
; A boolean value, corresponding to whether or not the expression returns
; true for all values in vars.
(define (for-all expr vars)
  (andmap expr vars))

; exists
;
; Implements the functionality of the "exists" logical quantifier.
;
; Parameters:
; expr (procedure): The expression over which the procedure will test.
; vars (list): A list of elements from a given universe.
;
; Returns:
; A boolean value, corresponding to whether or not the expression returns
; true for at least one of the values in vars.
(define (exists expr vars)
  (ormap expr vars))


; EXPRESSIONS AND STATEMENTS


; e1 and statement1
;
; Implements the expression: ∀x(isTree(x) → isPlant(x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e1 x)
 (implies (is-tree? x) (is-plant? x)))

(define statement1 (predicate-logic A (list 'forall) e1))

; e2 and statement2
;
; Implements the expression: ∃x∀y(isPlant(y) → isTree(x) ∧ ¬tallerThan(y, x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
; y (list): Secondary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e2 x y)
  (implies (is-plant? y)
           (and (is-tree? x)
                (not (taller-than? y x)))))

(define statement2 (predicate-logic A (list 'exists 'forall) e2))

; e3 and statement3
;
; Implements the expression: ∃x∃y(isTree(x) ∧ ¬isTree(y) ∧ tallerThan(y, x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
; y (list): Secondary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e3 x y)
(and (and (is-tree? x)
            (not (is-tree? y))) (taller-than? y x)))

(define statement3 (predicate-logic A (list 'exists 'exists) e3))

; e4 and statement4
;
; Implements the expression: ∀x(isStudent(x) → isPerson(x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e4 x)
  (implies (is-student? x)
          (is-person? x)))

(define statement4 (predicate-logic A (list 'forall) e4))

; e5 and statement5
;
; Implements the expression: ∃x(isFaculty(x) ∧ isStudent(x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e5 x)
  (and (is-faculty? x)
       (is-student? x)))

(define statement5 (predicate-logic A (list 'exists) e5))
         
; e6 and statement6
;
; Implements the expression: ∃x∃y∃z(isFaculty(x) ∧ isStudent(y) ∧ isCourse(z) ∧ teachesTo(x, z, y))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
; y (list): Secondary quantifier
; z (list): Tertiary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e6 x y z)
  (and (is-faculty? x) (is-student? y) (is-course? z)
                              (teaches-to? x z y)))

(define statement6 (predicate-logic A (list 'exists 'exists 'exists) e6))

; e7 and statement7
;
; Implements the expression: ∀x(isFaculty(x) → ¬isStudent(x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e7 x)
  (implies (is-faculty? x)
                  (not (is-student? x))))

(define statement7 (predicate-logic A (list 'forall) e7))

; e8 and statement8
;
; Implements the expression: ∀x∃y(isStudent(x) → isCourse(y))

; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
; y (list): Secondary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e8 x y)
  (implies (is-student? x) (is-course? y)))

(define statement8 (predicate-logic A (list 'forall 'exists) e8))

; e9 and statement9
;
; Implements the expression: ∃x(isPlant(x) → isTree(x))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e9 x)
  (implies (is-plant? x)
           (is-tree? x)))

(define statement9 (predicate-logic A (list 'exists) e9))

; e10 and statement10
;
; Implements the expression: ∀x∃y(isPlant(x) → ¬isClass(y))
; Includes a statement that passes the expression into
; predicate-logic with additional parameters.
;
; Parameters:
; x (list): Primary quantifier
; y (list): Secondary quantifier
;
; Returns:
; A boolean value, corresponding to whether or not the
; logical expression results in a value of true or false.
(define (e10 x y)
  (implies (is-plant? x) (not (is-course? y))))

(define statement10 (predicate-logic A (list 'forall 'exists) e10))